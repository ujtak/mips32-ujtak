% load "parameters.rb"

module alu(/*AUTOARG*/);
`include "parameters.vh"
`include "alu.vh"

  /*AUTOINPUT*/
  input                 clk;
  input                 xrst;
  input [DWIDTH-1:0]    in_a;
  input [DWIDTH-1:0]    in_b;
  input [ALUWIDTH-1:0]  alu_code;

  /*AUTOOUTPUT*/
  output              zero;
  output [DWIDTH-1:0] result;

  /*AUTOWIRE*/

  /*AUTOREG*/
  reg [DWIDTH-1:0] r_result;

  assign zero = result == 0;
  assign result = r_result;

  always @(posedge clk)
    if (!xrst)
      r_result <= 0;
    else
      case (alu_code)
        ALU_AND:  r_result <= in_a & in_b;
        ALU_OR:   r_result <= in_a | in_b;
        ALU_ADD:  r_result <= in_a + in_b;
        ALU_SUB:  r_result <= in_a - in_b;
        ALU_SLT:  r_result <= in_a < in_b;
        ALU_NOR:  r_result <= ~(in_a | in_b);
        default:  r_result <= 0;
      endcase

endmodule

